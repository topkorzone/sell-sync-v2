### Marketplace Hub API Test
### IntelliJ HTTP Client / VS Code REST Client

### ============================================
### Variables
### ============================================

@baseUrl = http://localhost:8080
@contentType = application/json

# 로그인 후 받은 access_token을 여기에 설정
@accessToken = eyJhbGciOiJFUzI1NiIsImtpZCI6IjVjY2NmZjNmLTM5ZTYtNDZjZS1hYWI5LTgwMjM1YjAzMGZkZSIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL25ud2N1aGFteGpxZ215enB0YnliLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiJkMTI2ZjM0Mi1hMzY5LTQ1ZjktYWZjZi0zMGUwYWEzNjExYTQiLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzcwMzA4NDU4LCJpYXQiOjE3NzAzMDQ4NTgsImVtYWlsIjoiYWRtaW5Ac2VsbC1zeW5jLmNvbSIsInBob25lIjoiIiwiYXBwX21ldGFkYXRhIjp7InByb3ZpZGVyIjoiZW1haWwiLCJwcm92aWRlcnMiOlsiZW1haWwiXSwicm9sZSI6ImFkbWluIiwidGVuYW50X2lkIjoiYWM0NWY4OWItN2ZlZS00ZDAyLWJkNWQtNmQzYTk4YjU4MjRkIn0sInVzZXJfbWV0YWRhdGEiOnsiZW1haWxfdmVyaWZpZWQiOnRydWV9LCJyb2xlIjoiYXV0aGVudGljYXRlZCIsImFhbCI6ImFhbDEiLCJhbXIiOlt7Im1ldGhvZCI6InBhc3N3b3JkIiwidGltZXN0YW1wIjoxNzcwMzA0ODU4fV0sInNlc3Npb25faWQiOiIwMTZhNzY5Zi1iYjYwLTQ5ZDktYjc2MS1mMmE4ODA0MWM0YTgiLCJpc19hbm9ueW1vdXMiOmZhbHNlfQ.ikcRTVRJ0N7QPUmpkV4Ow22vIYyorK81rnvOul-lLkHmSLE_-ERiiGJzu1ayUuABIhRq6Nwc7SADRonK_csaMg


### ============================================
### 1. Health Check
### ============================================

### 서버 상태 확인
GET {{baseUrl}}/actuator/health

###

### API 상태 확인
GET {{baseUrl}}/api/v1/health


### ============================================
### 2. Auth - 인증
### ============================================

### 로그인
# @name login
POST {{baseUrl}}/api/v1/auth/login
Content-Type: {{contentType}}

{
  "email": "admin@sell-sync.com",
  "password": "Password1!"
}

###

### 현재 사용자 정보
GET {{baseUrl}}/api/v1/auth/me
Authorization: Bearer {{accessToken}}

###

### 로그아웃
POST {{baseUrl}}/api/v1/auth/logout
Authorization: Bearer {{accessToken}}


### ============================================
### 3. Settings - 마켓플레이스 자격증명
### ============================================

### 마켓플레이스 자격증명 목록 조회
GET {{baseUrl}}/api/v1/settings/marketplaces
Authorization: Bearer {{accessToken}}

###

### 네이버 스마트스토어 연결 테스트
POST {{baseUrl}}/api/v1/settings/marketplaces/test-connection
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

{
  "marketplaceType": "NAVER",
  "sellerId": "your-seller-id",
  "clientId": "your-client-id",
  "clientSecret": "$2a$04$xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
}

###

### 쿠팡 연결 테스트
POST {{baseUrl}}/api/v1/settings/marketplaces/test-connection
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

{
  "marketplaceType": "COUPANG",
  "sellerId": "A00123456",
  "clientId": "your-access-key",
  "clientSecret": "your-secret-key"
}

###

### 네이버 자격증명 저장
POST {{baseUrl}}/api/v1/settings/marketplaces
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

{
  "marketplaceType": "NAVER",
  "sellerId": "your-seller-id",
  "clientId": "your-client-id",
  "clientSecret": "$2a$04$xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
}

###

### 쿠팡 자격증명 저장
POST {{baseUrl}}/api/v1/settings/marketplaces
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

{
  "marketplaceType": "COUPANG",
  "sellerId": "A00123456",
  "clientId": "your-access-key",
  "clientSecret": "your-secret-key"
}


### ============================================
### 4. Order Sync - 주문 수집
### ============================================

### 전체 마켓플레이스 주문 동기화 (최근 2시간)
POST {{baseUrl}}/api/v1/orders/sync
Authorization: Bearer {{accessToken}}

###

### 전체 마켓플레이스 주문 동기화 (최근 24시간)
POST {{baseUrl}}/api/v1/orders/sync?hours=24
Authorization: Bearer {{accessToken}}
1
###

### 특정 날짜 주문 동기화
POST {{baseUrl}}/api/v1/orders/sync?date=2026-02-05
Authorization: Bearer {{accessToken}}

###

### 네이버 주문 동기화 (최근 2시간)
POST {{baseUrl}}/api/v1/orders/sync/NAVER?hours=2
Authorization: Bearer {{accessToken}}

###

### 쿠팡 주문 동기화 (최근 2시간)
POST {{baseUrl}}/api/v1/orders/sync/COUPANG?hours=2
Authorization: Bearer {{accessToken}}


### ============================================
### 5. Orders - 주문 조회
### ============================================

### 주문 목록 조회
GET {{baseUrl}}/api/v1/orders?page=0&size=20
Authorization: Bearer {{accessToken}}

###

### 주문 목록 조회 (상태 필터)
GET {{baseUrl}}/api/v1/orders?status=COLLECTED&page=0&size=20
Authorization: Bearer {{accessToken}}

###

### 주문 목록 조회 (마켓플레이스 필터)
GET {{baseUrl}}/api/v1/orders?marketplace=NAVER&page=0&size=20
Authorization: Bearer {{accessToken}}

###

### 주문 상세 조회
# orderId를 실제 주문 ID로 변경하세요
GET {{baseUrl}}/api/v1/orders/your-order-id-here
Authorization: Bearer {{accessToken}}

###

### 주문 출고 처리 (상태를 SHIPPING으로 변경)
# orderId를 실제 주문 ID로 변경하세요
POST {{baseUrl}}/api/v1/orders/your-order-id-here/ship
Authorization: Bearer {{accessToken}}


### ============================================
### 6. Dashboard - 대시보드
### ============================================

### 대시보드 통계 조회
GET {{baseUrl}}/api/v1/dashboard/stats
Authorization: Bearer {{accessToken}}


### ============================================
### 7. ERP 설정 (선택)
### ============================================

### ERP 설정 목록 조회
GET {{baseUrl}}/api/v1/settings/erp
Authorization: Bearer {{accessToken}}

###

### 이카운트 ERP 연결 테스트
POST {{baseUrl}}/api/v1/settings/erp/test-connection
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

{
  "erpType": "ICOUNT",
  "companyCode": "your-company-code",
  "userId": "your-user-id",
  "apiKey": "your-api-key"
}

###

### ERP 품목 목록 조회
GET {{baseUrl}}/api/v1/erp/items?page=0&size=20
Authorization: Bearer {{accessToken}}

###

### ERP 품목 동기화
POST {{baseUrl}}/api/v1/erp/items/sync
Authorization: Bearer {{accessToken}}


### ============================================
### 8. 주문 상태 업데이트 (반품/취소 포함)
### ============================================

### 전체 마켓플레이스 미완료 주문 상태 업데이트
### - DB의 미완료 주문(최근 7일)을 마켓플레이스 API로 상태 조회
### - 쿠팡: 정상 배송 흐름 + 반품(RETURN)/취소(CANCEL) 상태 감지
### - 네이버: product-orders/query 배치 조회
POST {{baseUrl}}/api/v1/orders/status-update
Authorization: Bearer {{accessToken}}

###

### 쿠팡 주문 상태 업데이트
POST {{baseUrl}}/api/v1/orders/status-update/COUPANG
Authorization: Bearer {{accessToken}}

###

### 네이버 주문 상태 업데이트
POST {{baseUrl}}/api/v1/orders/status-update/NAVER
Authorization: Bearer {{accessToken}}

###

### 반품 주문 목록 조회
GET {{baseUrl}}/api/v1/orders?status=RETURNED&page=0&size=20
Authorization: Bearer {{accessToken}}

###

### 취소 주문 목록 조회
GET {{baseUrl}}/api/v1/orders?status=CANCELLED&page=0&size=20
Authorization: Bearer {{accessToken}}

###

### 반품+취소 주문 목록 조회 (복수 상태 필터)
GET {{baseUrl}}/api/v1/orders?statuses=RETURNED,CANCELLED&page=0&size=20
Authorization: Bearer {{accessToken}}


### ============================================
### 9. 수수료 계산
### ============================================

### 쿠팡 수수료 미계산 주문 일괄 계산
POST {{baseUrl}}/api/v1/orders/commission/calculate?marketplace=COUPANG
Authorization: Bearer {{accessToken}}
